# ZaloClone Frontend - Project Intelligence

## Message Binding Pattern âš ï¸
**Critical Fix Applied**: API response structure khÃ¡c vá»›i expected structure.

### Key Insight - API Response Structure
- API tráº£ vá» message data trong `messageData` field, KHÃ”NG pháº£i `message` field
- Response structure: `{ message: "success text", messageData: {...actual message data} }`
- [`sendMessage()`](src/store/chat.js:127) cáº§n extract tá»« `response.data.messageData`

### Best Practice
```javascript
// Always extract message tá»« Ä‘Ãºng field
const message = response.data.messageData || response.data.message

// Always ensure chatId cÃ³ sáºµn trÆ°á»›c khi process message
const chatId = message.chatId || (this.currentChat && this.currentChat._id)
```

## Debugging Strategy
- Add console.log vá»›i prefix emoji (ğŸ“¤ğŸ“¨âœ…âŒ) Ä‘á»ƒ dá»… track
- Check duplicate messages báº±ng `message._id`
- Verify reactive binding báº±ng Vue DevTools

## Message Flow
1. User gá»­i message â†’ [`sendMessage()`](src/store/chat.js:127) 
2. API call success â†’ ensure `chatId` exists
3. Call [`addMessage()`](src/store/chat.js:287) â†’ update UI
4. Socket broadcast â†’ other clients receive via [`message:new`](src/store/socket.js:112)

## Common Pitfalls
- KhÃ´ng kiá»ƒm tra `message.chatId` existence trÆ°á»›c khi bind
- Duplicate messages khi cáº£ API vÃ  Socket Ä‘á»u trigger addMessage
- Missing currentChat context khi process messages

## Vue Reactivity Notes
- Messages binding qua computed properties trong Chat.vue
- Watch `messagesCount` Ä‘á»ƒ auto-scroll
- Ensure Pinia state mutations trigger reactivity correctly